@import "~@angular/material/theming";
@import "~src/assets/styles/modules/typography";
@import "~src/assets/styles/modules/variables";

@mixin ckeditor-theme-styles($_theme-primary-color, $_theme-accent-color, $_theme-background, $_theme-foreground) {

    .ck {

        button,
        input,
        .ck-button_with-text,
        .ck-balloon-panel,
        .ck-dropdown__panel {
            border-radius: $roundness;
        }

        &.ck-dropdown__panel,
        &.ck-balloon-panel,
        &.ck-toolbar {
            @include mat-elevation(4);
            background-color: map-get($_theme-background, card);
            border: none;
        }

        &.ck-balloon-panel {

            &::before,
            &::after {
                display: none;
            }

            .ck-button,
            .ck-input-text {
                height: 40px;
            }

            .ck-button:not(.ck-button_with-text) {
                width: 40px;
            }

            .ck-button_with-text {
                line-height: 40px;
                padding: 0 0;

                .ck-button__label {
                    @include mat-typography-level-to-styles($base-typography, body-2);
                    color: $_theme-accent-color;
                    text-decoration: none !important;
                }
            }

            .ck-input-text {
                @include mat-typography-level-to-styles($base-typography, body-1);
                padding: 0 $layout-unit__base;

                &:focus {
                    border: none;
                    box-shadow: inset 0 0 0 2px $_theme-accent-color;
                }
            }
        }

        &.ck-button {
            box-shadow: none !important;
            color: map-get($_theme-foreground, text);
            cursor: pointer;

            &.ck-button-save {
                order: 2;
            }

            &:not(.ck-disabled) {

                &.ck-on,
                &:hover,
                &:focus,
                &:active {
                    background-color: map-get($_theme-foreground, divider);
                }
            }
        }

        &.ck-input-text {
            background: unset;
            box-shadow: none;
            color: map-get($_theme-foreground, text);
        }
    }

    ckeditor .ck-editor {

        .ck {

            &.ck-icon:not(.ck-dropdown__arrow) {
                height: 20px;
                width: 20px;
            }

            &.ck-button {
                box-shadow: none !important;
                cursor: pointer;

                &:not(.ck-disabled) {

                    &.ck-on,
                    &:hover,
                    &:focus,
                    &:active {
                        background-color: map-get($_theme-foreground, divider);
                    }
                }
            }

            &.ck-reset_all, &.ck.ck-reset_all * {
                color: map-get($_theme-foreground, text);
            }

            &.ck-editor__top {

                .ck-toolbar {
                    background-color: lighten(map-get($_theme-background, card), 6%);
                    border-color: map-get($_theme-foreground, divider);
                    box-shadow: none;
                }
            }

            &.ck-editor__main > .ck-editor__editable {
                @include mat-typography-level-to-styles($base-typography, body-1);
                background: unset;
                border-color: map-get($_theme-foreground, divider);

                &.ck-focused {
                    box-shadow: none;

                    .ck-widget.ck-widget_with-selection-handler {

                        &.ck-widget_selected {
                            outline-color: $_theme-accent-color;

                            .ck-widget__selection-handler {
                                background-color: $_theme-accent-color;
                            }
                        }
                    }
                }

                table {
                    border-color: map-get($_theme-foreground, disabled-text);

                    th,
                    td {
                        border-color: map-get($_theme-foreground, divider);
                    }

                    th {
                        background-color: lighten(map-get($_theme-background, card), 8%);
                    }

                    td {

                        &.ck-editor__nested-editable {
                            background: unset !important;
                            box-shadow: none !important;

                            &.ck-editor__nested-editable_focused {
                                border-color: $_theme-accent-color;
                            }
                        }
                    }
                }
            }

            &.ck-dropdown__panel {
                @include mat-elevation(4);
                background-color: map-get($_theme-background, card);
                border: none;
            }
        }

        .ck-insert-table-dropdown-grid-box {
            border-color: map-get($_theme-foreground, disabled-text);

            &.ck-on {
                background-color: transparentize($_theme-accent-color, .76);
                border-color: $_theme-accent-color;
            }
        }


        .ck-insert-table-dropdown__label {
            padding: $layout-unit__base;

            @extend .mat-overline;
        }
    }
}
